select activity_name, date_trunc('week', start_time_local), start_time_local, trunc((distance/1000)::numeric, 3) distance, TO_CHAR((duration || ' second')::interval, 'HH24h:MI:SS') duration, round(training_effect::numeric, 2) from garmin_activity_details  where activity_type_id=1 order by start_time_local;
select date_trunc('week', start_time_local) weekly,  trunc((sum(distance)/1000)::numeric, 3) distance, TO_CHAR((sum(duration) || ' second')::interval, 'HH24h:MI:SS') duration, round((sum(training_effect)/count(*))::numeric, 2) avg_training_effect, array_agg(round(training_effect::numeric, 2)::text) sum_train
 ing_effect from garmin_activity_details  where activity_type_id in (1,6) group by weekly order by weekly;